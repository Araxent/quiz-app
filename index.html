<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>📺 Suivi de Séries</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900 min-h-screen p-4">
  <div class="max-w-xl mx-auto bg-white rounded-2xl shadow-lg p-6">
    <h1 class="text-3xl font-bold mb-6 text-center">📺 Suivi de Séries</h1>

    <form id="seriesForm" class="flex flex-col gap-3 mb-6">
      <label class="font-medium">Nom de série</label>
      <input type="text" id="title" placeholder="Nom de ta série" class="p-2 rounded border" required />
      <input type="number" id="total" placeholder="Nombre total d'épisodes" class="p-2 rounded border" required />
      <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
        ➕ Ajouter
      </button>
    </form>

    <div id="seriesList" class="space-y-6"></div>
  </div>

  <script>
    const form = document.getElementById('seriesForm');
    const seriesList = document.getElementById('seriesList');
    let series = JSON.parse(localStorage.getItem('series')) || [];

    function saveAndRender() {
      localStorage.setItem('series', JSON.stringify(series));
      render();
    }

    function render() {
      seriesList.innerHTML = '';
      series.forEach((s, i) => {
        const percent = Math.round((s.current / s.total) * 100);
        const div = document.createElement('div');
        div.className = 'border-b pb-4';
        div.innerHTML = `
          <div class="flex justify-between items-center">
            <h2 class="text-lg font-semibold">📘 ${s.title}</h2>
            <button class="text-red-500 hover:underline" data-remove="${i}">🗑 Supprimer</button>
          </div>
          <div class="text-sm text-gray-600">Épisode ${s.current} / ${s.total}</div>
          <div class="w-full bg-gray-200 h-2 rounded">
            <div class="bg-blue-500 h-2 rounded" style="width:${percent}%"></div>
          </div>
          <div class="flex gap-2 mt-2">
            <button class="bg-gray-200 px-3 py-1 rounded text-sm" data-minus="${i}">-1</button>
            <button class="bg-gray-200 px-3 py-1 rounded text-sm" data-plus="${i}">+1</button>
          </div>
        `;
        seriesList.appendChild(div);
      });
    }

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const title = document.getElementById('title').value.trim();
      const total = parseInt(document.getElementById('total').value);
      if (!title || isNaN(total)) return;
      series.push({ title, total, current: 0 });
      form.reset();
      saveAndRender();
    });

    seriesList.addEventListener('click', (e) => {
      if (e.target.dataset.plus !== undefined) {
        const i = e.target.dataset.plus;
        if (series[i].current < series[i].total) series[i].current++;
        saveAndRender();
      }
      if (e.target.dataset.minus !== undefined) {
        const i = e.target.dataset.minus;
        if (series[i].current > 0) series[i].current--;
        saveAndRender();
      }
      if (e.target.dataset.remove !== undefined) {
        const i = e.target.dataset.remove;
        series.splice(i, 1);
        saveAndRender();
      }
    });

    render();
  </script>
</body>
</html>
